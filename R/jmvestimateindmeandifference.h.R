
# This file is automatically generated, you probably don't want to edit this

jmvEstimateIndMeanDifferenceOptions <- if (requireNamespace('jmvcore')) R6::R6Class(
    "jmvEstimateIndMeanDifferenceOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            switch = "fromraw",
            y = NULL,
            x = NULL,
            reference.group = FALSE,
            m1 = NULL,
            m2 = NULL,
            s1 = NULL,
            s2 = NULL,
            n1 = NULL,
            n2 = NULL,
            conf.level = 95,
            var.equal = TRUE,
            ymin = "auto",
            ymax = "auto",
            ylab = NULL,
            xlab = NULL,
            g1lab = "auto",
            g2lab = "auto",
            g1color = "white",
            g2color = "gray75",
            bsize = 2,
            bcex = 1,
            ropeBottom = "none",
            ropeTop = "none", ...) {

            super$initialize(
                package='esci',
                name='jmvEstimateIndMeanDifference',
                requiresData=TRUE,
                ...)

            private$..switch <- jmvcore::OptionList$new(
                "switch",
                switch,
                default="fromraw",
                options=list(
                    "fromraw",
                    "fromsummary"))
            private$..y <- jmvcore::OptionVariable$new(
                "y",
                y)
            private$..x <- jmvcore::OptionVariable$new(
                "x",
                x)
            private$..reference.group <- jmvcore::OptionBool$new(
                "reference.group",
                reference.group,
                default=FALSE)
            private$..m1 <- jmvcore::OptionNumber$new(
                "m1",
                m1)
            private$..m2 <- jmvcore::OptionNumber$new(
                "m2",
                m2)
            private$..s1 <- jmvcore::OptionNumber$new(
                "s1",
                s1)
            private$..s2 <- jmvcore::OptionNumber$new(
                "s2",
                s2)
            private$..n1 <- jmvcore::OptionNumber$new(
                "n1",
                n1)
            private$..n2 <- jmvcore::OptionNumber$new(
                "n2",
                n2)
            private$..conf.level <- jmvcore::OptionNumber$new(
                "conf.level",
                conf.level,
                min=50,
                max=99.9999,
                default=95)
            private$..var.equal <- jmvcore::OptionBool$new(
                "var.equal",
                var.equal,
                default=TRUE)
            private$..ymin <- jmvcore::OptionString$new(
                "ymin",
                ymin,
                default="auto")
            private$..ymax <- jmvcore::OptionString$new(
                "ymax",
                ymax,
                default="auto")
            private$..ylab <- jmvcore::OptionString$new(
                "ylab",
                ylab)
            private$..xlab <- jmvcore::OptionString$new(
                "xlab",
                xlab)
            private$..g1lab <- jmvcore::OptionString$new(
                "g1lab",
                g1lab,
                default="auto")
            private$..g2lab <- jmvcore::OptionString$new(
                "g2lab",
                g2lab,
                default="auto")
            private$..g1color <- jmvcore::OptionString$new(
                "g1color",
                g1color,
                default="white")
            private$..g2color <- jmvcore::OptionString$new(
                "g2color",
                g2color,
                default="gray75")
            private$..bsize <- jmvcore::OptionNumber$new(
                "bsize",
                bsize,
                min=0.5,
                max=10,
                default=2)
            private$..bcex <- jmvcore::OptionNumber$new(
                "bcex",
                bcex,
                min=0.5,
                max=10,
                default=1)
            private$..ropeBottom <- jmvcore::OptionString$new(
                "ropeBottom",
                ropeBottom,
                default="none")
            private$..ropeTop <- jmvcore::OptionString$new(
                "ropeTop",
                ropeTop,
                default="none")

            self$.addOption(private$..switch)
            self$.addOption(private$..y)
            self$.addOption(private$..x)
            self$.addOption(private$..reference.group)
            self$.addOption(private$..m1)
            self$.addOption(private$..m2)
            self$.addOption(private$..s1)
            self$.addOption(private$..s2)
            self$.addOption(private$..n1)
            self$.addOption(private$..n2)
            self$.addOption(private$..conf.level)
            self$.addOption(private$..var.equal)
            self$.addOption(private$..ymin)
            self$.addOption(private$..ymax)
            self$.addOption(private$..ylab)
            self$.addOption(private$..xlab)
            self$.addOption(private$..g1lab)
            self$.addOption(private$..g2lab)
            self$.addOption(private$..g1color)
            self$.addOption(private$..g2color)
            self$.addOption(private$..bsize)
            self$.addOption(private$..bcex)
            self$.addOption(private$..ropeBottom)
            self$.addOption(private$..ropeTop)
        }),
    active = list(
        switch = function() private$..switch$value,
        y = function() private$..y$value,
        x = function() private$..x$value,
        reference.group = function() private$..reference.group$value,
        m1 = function() private$..m1$value,
        m2 = function() private$..m2$value,
        s1 = function() private$..s1$value,
        s2 = function() private$..s2$value,
        n1 = function() private$..n1$value,
        n2 = function() private$..n2$value,
        conf.level = function() private$..conf.level$value,
        var.equal = function() private$..var.equal$value,
        ymin = function() private$..ymin$value,
        ymax = function() private$..ymax$value,
        ylab = function() private$..ylab$value,
        xlab = function() private$..xlab$value,
        g1lab = function() private$..g1lab$value,
        g2lab = function() private$..g2lab$value,
        g1color = function() private$..g1color$value,
        g2color = function() private$..g2color$value,
        bsize = function() private$..bsize$value,
        bcex = function() private$..bcex$value,
        ropeBottom = function() private$..ropeBottom$value,
        ropeTop = function() private$..ropeTop$value),
    private = list(
        ..switch = NA,
        ..y = NA,
        ..x = NA,
        ..reference.group = NA,
        ..m1 = NA,
        ..m2 = NA,
        ..s1 = NA,
        ..s2 = NA,
        ..n1 = NA,
        ..n2 = NA,
        ..conf.level = NA,
        ..var.equal = NA,
        ..ymin = NA,
        ..ymax = NA,
        ..ylab = NA,
        ..xlab = NA,
        ..g1lab = NA,
        ..g2lab = NA,
        ..g1color = NA,
        ..g2color = NA,
        ..bsize = NA,
        ..bcex = NA,
        ..ropeBottom = NA,
        ..ropeTop = NA)
)

jmvEstimateIndMeanDifferenceResults <- if (requireNamespace('jmvcore')) R6::R6Class(
    inherit = jmvcore::Group,
    active = list(
        text = function() private$.items[["text"]],
        ctmTable = function() private$.items[["ctmTable"]],
        notes = function() private$.items[["notes"]],
        smd = function() private$.items[["smd"]],
        decisionMakingTitle = function() private$.items[["decisionMakingTitle"]],
        decisionMaking = function() private$.items[["decisionMaking"]],
        plot = function() private$.items[["plot"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Estimate Independent Mean Difference")
            self$add(jmvcore::Html$new(
                options=options,
                name="text",
                title="Instructions/Errors",
                visible=FALSE))
            self$add(jmvcore::Table$new(
                options=options,
                name="ctmTable",
                title="Compare Two Means",
                visible=TRUE,
                rows=3,
                columns=list(
                    list(
                        `name`="Condition", 
                        `type`="text"),
                    list(
                        `name`="m", 
                        `title`="M", 
                        `type`="number"),
                    list(
                        `name`="CI_low", 
                        `title`="Lower", 
                        `type`="number"),
                    list(
                        `name`="CI_high", 
                        `title`="Upper", 
                        `type`="number"),
                    list(
                        `name`="s", 
                        `title`="s", 
                        `type`="number"),
                    list(
                        `name`="n", 
                        `title`="N", 
                        `type`="integer"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="notes",
                title="Notes",
                visible=TRUE))
            self$add(jmvcore::Html$new(
                options=options,
                name="smd",
                title="Standardized Mean Difference",
                visible=TRUE))
            self$add(jmvcore::Preformatted$new(
                options=options,
                name="decisionMakingTitle",
                title="Decision Making",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="decisionMaking",
                visible=TRUE,
                title="t-table",
                rows=1,
                columns=list(
                    list(
                        `name`="t", 
                        `type`="number"),
                    list(
                        `name`="df", 
                        `type`="number"),
                    list(
                        `name`="p", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="plot",
                visible=TRUE,
                title="Descriptives Plot",
                width=500,
                height=600,
                requiresData=TRUE,
                renderFun=".plot"))}))

jmvEstimateIndMeanDifferenceBase <- if (requireNamespace('jmvcore')) R6::R6Class(
    "jmvEstimateIndMeanDifferenceBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = 'esci',
                name = 'jmvEstimateIndMeanDifference',
                version = c(1,0,0),
                options = options,
                results = jmvEstimateIndMeanDifferenceResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE)
        }))

#' Estimate Independent Mean Difference
#'
#' 
#' @param switch .
#' @param data .
#' @param y .
#' @param x .
#' @param reference.group .
#' @param m1 .
#' @param m2 .
#' @param s1 .
#' @param s2 .
#' @param n1 .
#' @param n2 .
#' @param conf.level .
#' @param var.equal .
#' @param ymin .
#' @param ymax .
#' @param ylab .
#' @param xlab .
#' @param g1lab .
#' @param g2lab .
#' @param g1color .
#' @param g2color .
#' @param bsize .
#' @param bcex .
#' @param ropeBottom .
#' @param ropeTop .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$text} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$ctmTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$notes} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$smd} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$decisionMakingTitle} \tab \tab \tab \tab \tab a preformatted \cr
#'   \code{results$decisionMaking} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$plot} \tab \tab \tab \tab \tab an image \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$ctmTable$asDF}
#'
#' \code{as.data.frame(results$ctmTable)}
#'
#' @export
jmvEstimateIndMeanDifference <- function(
    switch = "fromraw",
    data,
    y,
    x,
    reference.group = FALSE,
    m1=0,
    m2=0,
    s1=0,
    s2=0,
    n1=0,
    n2=0,
    conf.level = 95,
    var.equal = TRUE,
    ymin = "auto",
    ymax = "auto",
    ylab,
    xlab,
    g1lab = "auto",
    g2lab = "auto",
    g1color = "white",
    g2color = "gray75",
    bsize = 2,
    bcex = 1,
    ropeBottom = "none",
    ropeTop = "none") {

    if ( ! requireNamespace('jmvcore'))
        stop('jmvEstimateIndMeanDifference requires jmvcore to be installed (restart may be required)')

    if ( ! missing(y)) y <- jmvcore::resolveQuo(jmvcore::enquo(y))
    if ( ! missing(x)) x <- jmvcore::resolveQuo(jmvcore::enquo(x))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(y), y, NULL),
            `if`( ! missing(x), x, NULL))


    options <- jmvEstimateIndMeanDifferenceOptions$new(
        switch = switch,
        y = y,
        x = x,
        reference.group = reference.group,
        m1 = m1,
        m2 = m2,
        s1 = s1,
        s2 = s2,
        n1 = n1,
        n2 = n2,
        conf.level = conf.level,
        var.equal = var.equal,
        ymin = ymin,
        ymax = ymax,
        ylab = ylab,
        xlab = xlab,
        g1lab = g1lab,
        g2lab = g2lab,
        g1color = g1color,
        g2color = g2color,
        bsize = bsize,
        bcex = bcex,
        ropeBottom = ropeBottom,
        ropeTop = ropeTop)

    analysis <- jmvEstimateIndMeanDifferenceClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}
